makedepends=(systemd accountsservice nss libcanberra gnome-session upower iso-codes pam)

description="Library for Graphical logins and managing local and remote displays."
url="http://www.gnome.org/"

packager="Yaolinux Team"
maintainer="rems"

name=gdm
version=3.38.2
release=5

source=(http://ftp.gnome.org/pub/gnome/sources/gdm/${version%.*}/gdm-$version.tar.xz )

build() {
cd gdm-$version

./configure --prefix=/usr        \
            --sysconfdir=/etc    \
            --localstatedir=/var \
            --with-run-dir=/run/gdm \
            --enable-gdm-xsession \
            --enable-ipv6    \
            --enable-authentication-scheme=pam \
            --disable-static  \
            --with-xdmcp=yes \
            --with-xinerama \
            --with-selinux \
            --without-plymouth \
            --without-xevie \
            --disable-schemas-compile \
            --without-tcp-wrappers \
            --with-pam-mod-dir=/lib/security \
            --with-initial-vt=7 \
            --with-default-pam-config=lfs

make
make DESTDIR=$PKG install

install -Dm644 /dev/stdin "$PKG/usr/lib/sysusers.d/gdm.conf" <<END
g gdm 120 -
u gdm 120 "Gnome Display Manager" /var/lib/gdm
END
}
